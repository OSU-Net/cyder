{% extends "cydhcp/cydhcp_base.html" %}
{% from "base/tables.html" import render_table %}


{% block title %}
  Range {{ range_.start_str }} to {{ range_.end_str }}
{% endblock %}

{% block action_bar %}
  {% if range_.network.pk %}
    <a href="{{ url('build-network', range_.network.pk) }}">DHCP Build Output</a>
  {% endif %}
{% endblock %}

{% block content %}
    {{ render_table(request, range_table) }}

    {% if allow_list %}
      <h3>Allowed</h3>
      <table class="table">
          <thead><th>Allowed</th></thead>
          <tbody>
            {% for allow in allow_list %}
              <tr><td>{{ allow }}</td></tr>
            {% endfor %}
          </tbody>
      </table>
    {% endif %}

    {% if attrs_table %}
      <h3>Range Options</h3>
      {{ render_table(request, attrs_table) }}
    {% endif %}

    {% if range_data %}
      <h3>Range Usage: {{ range_used }}</h3>
      {% with page_obj = range_data %}
        {% include "base/includes/pagination.html" %}
      {% endwith %}
      <table class="table">
        <thead>
          <th>IP</th>
          <th>Object</th>
          <th>Action</th>
        </thead>
        <tbody>
          {% for object in range_data %}
            <tr>
              <td>{{ object[1] }}</td>
              {% if object[0] == "A/PTR" %}
                <td>
                  {{ object[3].fqdn }} (<a href="{{ object[3].get_detail_url() }}">A</a>/<a href="{{ object[2].get_detail_url() }}">PTR</a>)
                </td>
                <td>
                  <b>Combine</b> <a class='combine_to_system' rel="{{ object[3].pk}}|{{ object[2].pk }}" href="/cydhcp/interface/combine_a_ptr_to_interface/{{ object[3].pk}}/{{ object[2].pk }}/">A/PTR to Interface.</a>
                </td>
              {% elif object[0] == "Interface" %}
                <td>
                  Interface (<a href="{{ object[2].get_detail_url() }}">{{ object[2].fqdn }}</a>) for System
                  <a href="{{ object[2].system.get_detail_url() }}">{{ object[2].system }}</a>
                </td>
                <td></td>
              {% elif object[0] == "A" %}
                <td>
                  A <a href="{{ object[2].get_detail_url() }}">{{ object[2].fqdn }}</a>
                </td>
                <td></td>
              {% elif object[0] == "PTR" %}
                <td>
                  PTR <a href="{{ object[2].get_detail_url() }}">{{ object[2].name }}</a>
                </td>
                <td></td>
              {% else %}
                <td><b>Free</b></td>
                  <td>
                      Create <a href="/cydns/address_record/create/?ip_str={{ object[1]}}&ip_type=4">A</a>
                      <a href="/cydns/ptr/create/?ip_str={{ object[1]}}&ip_type=4">PTR</a>
                      <a href="/cydhcp/interface/create/?ip_str={{ object[1]}}&ip_type=4">Interface</a>
                  </td>
              {% endif %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}
{% endblock %}
