{% extends "cydhcp/cydhcp_detail.html" %}
{% from "base/tables.html" import render_table %}
{% from "base/utility.html" import create_button %}


{% block title %}
  Range {{ obj.start_str }} to {{ obj.end_str }}
{% endblock %}

{% block content %}
  {% if obj.network.pk %}
    <a href="{{ url('build-network', obj.network.pk) }}">DHCP Build Output</a>
  {% endif %}

  {{ render_table(request, ranges_table) }}

  {% if allow_list %}
    <h3>Allowed</h3>
    <table class="table">
        <thead><th>Allowed</th></thead>
        <tbody>
          {% for allow in allow_list %}
            <tr><td>{{ allow }}</td></tr>
          {% endfor %}
        </tbody>
    </table>
  {% endif %}

  {% if attrs_table %}
    <h3>Range Options</h3>
    {{ render_table(request, attrs_table) }}
  {% endif %}

  {% if range_data %}
    <h3>Range Usage: {{ range_used }}</h3>
    {% with page_obj = range_data %}
      {% include "base/includes/pagination.html" %}
    {% endwith %}
    <table class="table">
      <thead>
        <th>IP</th>
        <th>Object</th>
        <th>Action</th>
      </thead>
      <tbody>
        {% for obj in range_data %}
          <tr>
            <td>{{ obj[1] }}</td>
            {% if obj[0] == "A/PTR" %}
              <td>
                {{ obj[3].fqdn }} (<a href="{{ obj[3].get_detail_url() }}">A</a>/<a href="{{ obj[2].get_detail_url() }}">PTR</a>)
              </td>
              <td>
                <b>Combine</b> <a class='combine_to_system' rel="{{ obj[3].pk}}|{{ obj[2].pk }}" href="/cydhcp/interface/combine_a_ptr_to_interface/{{ obj[3].pk}}/{{ obj[2].pk }}/">A/PTR to Interface.</a>
              </td>
            {% elif obj[0] == "Interface" %}
              <td>
                Interface (<a href="{{ obj[2].get_detail_url() }}">{{ obj[2].fqdn }}</a>) for System
                <a href="{{ obj[2].system.get_detail_url() }}">{{ obj[2].system }}</a>
              </td>
              <td></td>
            {% elif obj[0] == "A" %}
              <td>
                A <a href="{{ obj[2].get_detail_url() }}">{{ obj[2].fqdn }}</a>
              </td>
              <td></td>
            {% elif obj[0] == "PTR" %}
              <td>
                PTR <a href="{{ obj[2].get_detail_url() }}">{{ obj[2].name }}</a>
              </td>
              <td></td>
            {% else %}
              <td><b>Free</b></td>
              <td>
                {{ create_button(
                    'address_record', url('cydns-get-record'), data=obj[-1]) }}
                {{ create_button(
                    'ptr', url('cydns-get-record'), data=obj[-1]) }}
                {{ create_button(
                    'static_interface', url('cydhcp-get-record'), data=obj[-1]) }}
              </td>
            {% endif %}
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
{% endblock %}
