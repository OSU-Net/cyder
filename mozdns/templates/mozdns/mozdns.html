{% extends "mozdns/mozdns_base.html" %}

{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

{% block dns_content %}
    <h1>Moz DNS</h1>
    <style>
        div.inline {
            float:left;
            margin-right:50px;
        }
        #dns_form_errors {
            float:left;
            margin-top:50px;
            font-size: 15px;
            color: rgb(184,0,0);
            display: block;

        }
        #dns_success {
            float:left;
            margin-top:50px;
            font-size: 15px;
            color: rgb(50,205,50);
            display: block;

        }
        #inline {
            float:left;
            margin-right:50px;
        }
    </style>
    <script type="text/javascript">
        function display_disable(element_id){
            var ele = document.getElementById(element_id);
            var text = document.getElementById(element_id);
            ele.style.display = "none";
        }
        function display_enable(element_id){
            var ele = document.getElementById(element_id);
            var text = document.getElementById(element_id);
            ele.style.display = "block";
        }
        function do_A(e){
            reset_form();
            display_enable('A_display');
        }
        function do_MX(e){
            reset_form();
            display_enable('MX_display');
        }
        function do_NS(e){
            reset_form();
            display_enable('NS_display');
            update_fqdn('NS');
        }
        function do_PTR(e){
            reset_form();
            display_enable('PTR_display');
        }
        function do_CNAME(e){
            reset_form();
            display_enable('CNAME_display');
        }
        function do_SRV(e){
            reset_form();
            display_enable('SRV_display');
        }
        function do_TXT(e){
            reset_form();
            display_enable('TXT_display');
        }

        /*
           Either the Label or Domain changed.
        */
        function get_fqdn(rec_type){
            if (rec_type != 'NS'){
                var label = $('#' + rec_type + '_build_label').val();
                var domain = $('#' + rec_type + '_build_domain').find(":selected").text();
                if (label == "") {
                    var fqdn = "@       " + domain;
                } else {
                    var fqdn = label + "." + domain;
                }
            } else {
                var fqdn = $('#' + rec_type + '_build_domain').find(":selected").text();
            }
            return fqdn;
        }
        function update_text(rec_type){
            var text = $('#' + rec_type + '_build_text').val();
            var text_display = $('#' + rec_type + '_display_text');
            if (text == ""){
                text = "<i>" + text_display.attr('value') + "</i>";
            } else {
                text = '"' + text +'"';
            }
            document.getElementById(rec_type + '_display_text').innerHTML = text;

        }
        function update_view(view_name){
            // Nothing right now
            var ip = $('#' + rec_type + '_build_ip').val();
            if (ip !== undefined && ip.substring(0, "10.".length) === "10.") {
                // WTF JS? No startsWith in the string prototype?
                set_view('private', true);
                set_view('public', false);
            }
        }
        function set_view(rec_type, view_name, enabled){
            if(enabled === true){
                document.getElementById(rec_type + '_' + view_name + '_view').checked = true;
            } else {
                document.getElementById(rec_type + '_' + view_name + '_view').checked = false;
            }
        }
        function update_target_name(rec_type){
            var name = $('#' + rec_type + '_build_target_name').val();
            var target_name = $('#' + rec_type + '_display_target_name');
            if (name == ""){
                name = "<i>" + target_name.attr('value') + "</i>";
            } else {
                name = name + ".";
            }
            document.getElementById(rec_type + '_display_target_name').innerHTML = name;
        }
        function update_fqdn(rec_type){
            var fqdn = get_fqdn(rec_type);
            var rec_name = $('#' + rec_type + '_display_rec_name');
            rec_name.empty()
            // We put a '.' on the end to tell the user there is no ORIGIN being applied. The '.'
            // isn't actually sent during a POST
            if (fqdn == ""){
                fqdn = rec_name.value
            }
            document.getElementById(rec_type + '_display_rec_name').innerHTML = fqdn + "."
        }
        function update_ip(rec_type){
            var ip = $('#' + rec_type + '_build_ip').val();
            display_ip = $('#' + rec_type + '_display_ip');
            display_ip.empty();
            if (ip == "") {
                ip = "<i>IP</i>";
            } else if (ip.substring(0, "10.".length) === "10.") {
                // WTF JS? No startsWith in the string prototype?
                set_view(rec_type, 'private', true);
                set_view(rec_type, 'public', false);
            }
            document.getElementById(rec_type + '_display_ip').innerHTML = ip
        }
        function update_number(rec_type, number_name){
            var num = $('#' + rec_type + '_build_' + number_name).val();
            var display_num = $('#' + rec_type + '_display_' + number_name);
            //alert(rec_type + '_display_' + number_name);
            if (num == "" && display_num.attr('reset') == "true") {
                num = "<i>" + display_num.attr('value') + "</i>";
            }
            //display_num.empty();
            document.getElementById(rec_type + '_display_' + number_name).innerHTML = num
        }
        function update_comment(rec_type){
            var comment = $('#' + rec_type + '_build_comment').val();
            $('#' + rec_type + '_display_comment').empty();
            if (comment == "") {
                comment = "";
            } else {
                comment = "; " + comment
            }
            document.getElementById(rec_type + '_display_comment').innerHTML = comment
        }
        $(document).ready(function(){
            // Find the selected option and call it's onclick event
            // Register a bunch of listeners

            /*
               Call setup on selected choice and then reset the form
             */
            $('#rec_type_select').find(":selected").attr('onclick')();
            reset_form();
        });
        function reset_form(){
            rec_types = ['A', 'MX', 'NS', 'CNAME', 'SRV', 'TXT', 'PTR'];
            for (var i = 0; i < rec_types.length; i++){
                rec_type = rec_types[i];
                $('#' + rec_type + '_build').attr('pk', "");
                display_disable(rec_type + '_display');
            }
            /*
            display_disable('MX_display');
            display_disable('NS_display');
            display_disable('PTR_display');
            display_disable('CNAME_display');
            display_disable('SRV_display');
            display_disable('TXT_display');
            */
            // Clear any notifications
            $('#error_list').empty();
            $('#dns_success').empty();
            type_select = document.getElementById("rec_type_select");
            type_select_index = type_select.options.selectedIndex;
            document.getElementById("dns_form").reset();
            type_select.options[type_select_index].selected = true;
            var rec_type = type_select.value;
            display_enable(rec_type+"_display");
            /* Walk through and reset to default display values */
            final_display = document.getElementById(rec_type + "_final");
            arr = final_display.getElementsByClassName("inline");
            for (var i = 0; i < arr.length; i++){
                var element = $('#' + arr[i].id);
                if (element.attr('id') == rec_type + "_display_type" ) {
                    // Do nothing
                } else if (element.attr('reset') == 'false') {
                    element.attr('innerHTML', "<i>" + element.attr('value') + "</i>");
                } else if (element.attr('value') == "TTL"){
                    // TTL is stupid
                    element.attr('innerHTML', '');
                } else {
                    element.attr('innerHTML', '');
                }
            }
        }
        function get_ttl_comment(rec_type){
            var ttl = $('#' + rec_type + '_build_TTL').val();
            if (ttl != ""){
                commit_data['ttl'] = ttl;
            }
            var comment = $('#' + rec_type + '_build_comment').val();
            if (comment != ""){
                commit_data['comment'] = comment;
            }
            return commit_data
        }
        function get_views(rec_type){
            return {
                'public_view': $('#' + rec_type + '_public_view').attr('checked'),
                'private_view': $('#' + rec_type + '_private_view').attr('checked'),
            }
        }
        function get_label_domain(rec_type){
            var label = $('#' + rec_type + '_build_label').val();
            var domain = $('#' + rec_type + '_build_domain').find(":selected").text();
            commit_data = {
                'label': label,
                'domain': domain,
            }
            return commit_data
        }
        function submit_record(){
            type_select = document.getElementById("rec_type_select");
            type_select_index = type_select.options.selectedIndex;
            var rec_type = type_select.value;
            var pk = $('#' + rec_type + '_build').attr('pk')
            switch (rec_type) {
                // If pk is "" then this is a create. If it's non-empty this is an update.
                case 'A':
                    var ip_str = $('#' + rec_type + '_build_ip').val();
                    commit_data = {
                        'pk': pk,
                        'rtype': rec_type,
                        'ip_str': ip_str,
                    }
                    commit_data = jQuery.extend(commit_data, get_label_domain(rec_type));
                    commit_data = jQuery.extend(commit_data, get_ttl_comment(rec_type));
                    // This is where we post our data and handle the return data.
                    break;
                case 'PTR':
                    var target_name = $('#' + rec_type + '_build_target_name').val();
                    var ip_str = $('#' + rec_type + '_build_ip').val();
                    commit_data = {
                        'rtype': rec_type,
                        'name': target_name,
                        'ip_str': ip_str,
                    }
                    commit_data = jQuery.extend(commit_data, get_ttl_comment(rec_type));
                    break;
                case 'SRV':
                    var target_name = $('#' + rec_type + '_build_target_name').val();
                    var port = $('#' + rec_type + '_build_Port').val();
                    var weight = $('#' + rec_type + '_build_Weight').val();
                    var priority = $('#' + rec_type + '_build_Priority').val();
                    commit_data = {
                        'rtype': rec_type,
                        'target': target_name,
                        'port': port,
                        'weight': weight,
                        'priority': priority,
                    }
                    commit_data = jQuery.extend(commit_data, get_label_domain(rec_type));
                    commit_data = jQuery.extend(commit_data, get_ttl_comment(rec_type));
                    break;
                case 'CNAME':
                    var target_name = $('#' + rec_type + '_build_target_name').val();
                    commit_data = {
                        'rtype': rec_type,
                        'data': target_name,
                    }
                    commit_data = jQuery.extend(commit_data, get_label_domain(rec_type));
                    commit_data = jQuery.extend(commit_data, get_ttl_comment(rec_type));
                    break;
                case 'NS':
                    var target_name = $('#' + rec_type + '_build_target_name').val();
                    var domain = $('#' + rec_type + '_build_domain').find(":selected").text();
                    commit_data = {
                        'rtype': rec_type,
                        'server': target_name,
                        'domain': domain,
                    }
                    commit_data = jQuery.extend(commit_data, get_ttl_comment(rec_type));
                    break;
                case 'TXT':
                    var text = $('#' + rec_type + '_build_text').val();
                    var domain = $('#' + rec_type + '_build_domain').find(":selected").text();
                    commit_data = {
                        'rtype': rec_type,
                        'txt_data': text,
                    }
                    commit_data = jQuery.extend(commit_data, get_label_domain(rec_type));
                    commit_data = jQuery.extend(commit_data, get_ttl_comment(rec_type));
                    break;
                case 'MX':
                    var target_name = $('#' + rec_type + '_build_target_name').val();
                    var priority = $('#' + rec_type + '_build_Priority').val();
                    commit_data = {
                        'rtype': rec_type,
                        'server': target_name,
                        'priority': priority,
                    }
                    commit_data = jQuery.extend(commit_data, get_label_domain(rec_type));
                    commit_data = jQuery.extend(commit_data, get_ttl_comment(rec_type));
                    break;
            }
            commit_data = jQuery.extend(commit_data, get_views(rec_type));
            $.post('/mozdns/commit_record/', JSON.stringify(commit_data), function(data) {
                var data = jQuery.parseJSON(data)
                $('#error_list').empty();
                $('#dns_success').empty();
                if (data.errors){
                    for(var attr in data.errors) {
                        if(data.errors.hasOwnProperty(attr))
                            console.log(attr + ":" + data.errors[attr]);
                            // If you want to override the name of an Error, do it here.
                            switch (attr) {
                                case "__all__":
                                    error_name = "";
                                    break
                                case "ip_str":
                                    error_name = "IP:";
                                    break
                                default:
                                    error_name = attr + ": ";
                            }
                            // Error Output
                            $('#error_list').append("<li>" + error_name + data.errors[attr] + "</li>");
                    }
                } else {
                    // Success Output
                    $('#' + rec_type + '_build').attr('pk', data.obj_pk)
                    if (data.created) {
                        $('#dns_success').append("<span><a href='" + data.success + "'>Click to see the new "+
                            rec_type +" record</a>" + "</span>");
                    } else {
                        $('#dns_success').append("<span><a href='" + data.success + "'>Click to see the updated "+
                            rec_type +" record</a>" + "</span>");
                    }
                }
            });// end post
        }
    </script>
    <form id="dns_form">
    <input type='button' onclick='reset_form()' value="Reset">
    <input type='button' onclick='submit_record()' value="Commit">
    <select id="rec_type_select">
      <option value="A" onclick='do_A()'>A</option>
      <option value="MX" onclick='do_MX()'>MX</option>
      <option value="NS" onclick='do_NS()'>NS</option>
      <option value="PTR" onclick='do_PTR()'>PTR</option>
      <option value="CNAME" onclick='do_CNAME()'>CNAME</option>
      <option value="SRV" onclick='do_SRV()'>SRV</option>
      <option value="TXT" onclick='do_TXT()'>TXT</option>
    </select>

    <!--
        Input Macros: These make user inputs.
    -->

    {% macro input(id, value='', type='text', size=20) -%}
        <input  id="{{ id }}" type="{{ type }}" value="{{
            value|e }}" size="{{ size }}">
    {%- endmacro %}
    {% macro draw_build_label(rec_type) -%}
            Label: {{ input(rec_type + "_build_label") }}<br>
            <script>
            $('#{{rec_type}}_build_label').live("keydown", function(){ update_fqdn('{{ rec_type }}'); });
            $('#{{rec_type}}_build_label').live("keyup", function(){ update_fqdn('{{ rec_type }}'); });
            </script>
    {%- endmacro %}
    {% macro draw_build_ip(rec_type) -%}
            IP: {{ input(rec_type + "_build_ip") }}<br>
            <script>
            $('#{{ rec_type }}_build_ip').live("keydown", function(){ update_ip('{{ rec_type }}'); });
            $('#{{ rec_type }}_build_ip').live("keyup", function(){ update_ip('{{ rec_type }}'); });
            </script>
    {%- endmacro %}
    {% macro draw_build_comment(rec_type) -%}
            Comment: {{ input(rec_type + "_build_comment") }}<br>
            <script>
            $('#{{ rec_type }}_build_comment').live("keydown", function(){ update_comment('{{ rec_type }}'); });
            $('#{{ rec_type }}_build_comment').live("keyup", function(){ update_comment('{{ rec_type }}'); });
            </script>
    {%- endmacro %}
    {% macro draw_build_domain(rec_type, domains) -%}
            Domain: <select class="dispaly_inline" id="{{ rec_type }}_build_domain">
            {%- for domain in domains %}
                        <option value='{{ domain.pk }}'>{{ domain.name }}</option>
            {%- endfor %}
                    </select><br>
            <script>
            $('#{{ rec_type }}_build_domain').live("click", function(){ update_fqdn('{{ rec_type }}'); });
            </script>
    {%- endmacro %}
    {% macro draw_build_target_name(rec_type, description='Target') -%}
            {{ description }}: {{ input(rec_type + "_build_target_name") }}<br>
            <script>
            $('#{{rec_type}}_build_target_name').live("keydown", function(){ update_target_name('{{ rec_type }}'); });
            $('#{{rec_type}}_build_target_name').live("keyup", function(){ update_target_name('{{ rec_type }}'); });
            </script>
    {%- endmacro %}
    <!-- Number funcitons -->
    {% macro draw_build_number(rec_type, number_name, default="") -%}
            {{ number_name }}: {{ input(rec_type + "_build_" + number_name, value=default, size=10) }}<br>
            <script>
            // We are cheeting and using the same validator for all number types.
            $('#{{ rec_type }}_build_{{ number_name }}').live("keydown", function(){
                update_number('{{ rec_type }}', '{{ number_name }}');
            });
            $('#{{ rec_type }}_build_{{ number_name }}').live("keyup", function(){
                update_number('{{ rec_type }}', '{{ number_name }}');
            });
            </script>
    {%- endmacro %}
    {% macro draw_build_ttl(rec_type) -%}
            {{ draw_build_number(rec_type, 'TTL') }}
    {%- endmacro %}
    {% macro draw_build_views(rec_type) -%}
        <p><label>Views:</label>
        <ul>
            <li><label for="private_view"><input type="checkbox" name="views" value="1" id="{{ rec_type }}_private_view" /> private</label></li>
            <li><label for="public_view"><input type="checkbox" name="views" value="2" id="{{ rec_type }}_public_view" /> public</label></li>
        </ul>
            <script>
            $('#private_view').live("keydown", function(){ update_view('private'); });
            $('#public_view').live("keyup", function(){ update_view('public'); });
            </script>
    {%- endmacro %}
    {% macro draw_build_prio(rec_type) -%}
            {{ draw_build_number(rec_type, 'Priority') }}
    {%- endmacro %}
    <!-- End Number funcitons -->
    {% macro draw_build_text(rec_type, description='Text') -%}
            {{ description }}: {{ input(rec_type + "_build_text") }}<br>
            <script>
            $('#{{rec_type}}_build_text').live("keydown", function(){ update_text('{{ rec_type }}'); });
            $('#{{rec_type}}_build_text').live("keyup", function(){ update_text('{{ rec_type }}'); });
            </script>
    {%- endmacro %}

    <!--
        Display Macros: These make the display spans.
    -->
    {% macro display_rec_name(rec_type) -%}
            <div class="inline" reset='false' value="Name" id="{{ rec_type }}_display_rec_name"><i>Name</i></div>
    {%- endmacro %}
    {% macro display_rec_type(rec_type) -%}
            <div class="inline" reset='false' value="{{ rec_type }}" id="{{ rec_type }}_display_type"><b>{{ rec_type }}</b></div>
    {%- endmacro %}
    {% macro display_rec_ip(rec_type) -%}
            <div class="inline" reset='false' value="IP" id="{{ rec_type }}_display_ip"><i>IP</i></div>
    {%- endmacro %}
    {% macro display_rec_ttl(rec_type) -%}
            <div class="inline" reset='false' value="" id="{{ rec_type }}_display_TTL"></div>
    {%- endmacro %}
    {% macro display_rec_attr(rec_type, attr, default="", reset="false") -%}
            <div class="inline" reset='{{ reset }}' value="{{ attr }}" id="{{ rec_type }}_display_{{ attr }}"><i>{{ default }}</i></div>
    {%- endmacro %}
    {% macro display_rec_comment(rec_type) -%}
            <div class="inline" reset='true' id="{{ rec_type }}_display_comment"></div>
    {%- endmacro %}
    {% macro display_rec_text(rec_type) -%}
            <div class="inline" reset='false' id="{{ rec_type }}_display_text" value='Text'><i>Text</i></div>
    {%- endmacro %}
    {% macro display_target_name(rec_type) -%}
            <div class="inline" reset='false' value="Target" id="{{ rec_type }}_display_target_name"><i>Target</i></div>
    {%- endmacro %}
    <!--
    Every rec_build div has a pk attribute. If the pk attribute is set the value is send with the POST and let's
    the view know that this is an UPDATE. If pk is "" then the POST is considered to be a CREATE.
    -->
    <div id="A_display">
        <div class="rec_build" id="A_build" pk="">
            <table>
            <tr>
                <td>{{ draw_build_label('A') }}</td>
                <td>{{ draw_build_domain('A', domains) }}</td>
            </tr>
            <tr>
                <td>{{ draw_build_ip('A') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_ttl('A') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_comment('A') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_views('A') }}</td>
                <td></td>
            </tr>
            </table>
        </div>

        <div class="rec_final" id="A_final">
            {{ display_rec_name('A') }}
            {{ display_rec_type('A') }}
            {{ display_rec_ttl('A') }}
            {{ display_rec_ip('A') }}
            {{ display_rec_comment('A') }}
        </div>
    </div>

    <div id="MX_display">
        <div class="rec_build" id="MX_build">
            <table>
            <tr>
                <td>{{ draw_build_label('MX') }}</td>
                <td>{{ draw_build_domain('MX', domains) }}</td>
            </tr>
            <tr>
                <td>{{ draw_build_ttl('MX') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_prio('MX') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_target_name('MX') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_comment('MX') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_views('MX') }}</td>
                <td></td>
            </tr>
            </table>
        </div>

        <div class="rec_final" id="MX_final">
            {{ display_rec_name('MX') }}
            {{ display_rec_type('MX') }}
            {{ display_rec_ttl('MX') }}
            {{ display_rec_attr('MX', 'Priority', 'Priority', reset='true') }}
            {{ display_target_name('MX') }}
            {{ display_rec_comment('MX') }}
        </div>
    </div>
    <div id="NS_display">
        <div class="rec_build" id="NS_build">
            <table>
            <tr>
                <td>{{ draw_build_domain('NS', domains) }}</td>
            </tr>
            <tr>
                <td>{{ draw_build_ttl('NS') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_target_name('NS') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_comment('NS') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_views('NS') }}</td>
                <td></td>
            </tr>
            </table>
        </div>

        <div class="rec_final" id="NS_final">
            {{ display_rec_name('NS') }}
            {{ display_rec_type('NS') }}
            {{ display_rec_ttl('NS') }}
            {{ display_target_name('NS') }}
            {{ display_rec_comment('NS') }}
        </div>
    </div>
    <div id="PTR_display">
        <div class="rec_build" id="PTR_build">
            <table>
            <tr>
                <td>{{ draw_build_ip('PTR') }}</td>
            </tr>
            <tr>
                <td>{{ draw_build_ttl('PTR') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_target_name('PTR') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_comment('PTR') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_views('PTR') }}</td>
                <td></td>
            </tr>
            </table>
        </div>

        <div class="rec_final" id="PTR_final">
            {{ display_rec_ip('PTR') }}
            {{ display_rec_type('PTR') }}
            {{ display_rec_ttl('PTR') }}
            {{ display_target_name('PTR') }}
            {{ display_rec_comment('PTR') }}
        </div>
    </div>

    <div id="CNAME_display">
        <div class="rec_build" id="CNAME_build">
            <table>
            <tr>
                <td>{{ draw_build_label('CNAME') }}</td>
                <td>{{ draw_build_domain('CNAME', domains) }}</td>
            </tr>
            <tr>
                <td>{{ draw_build_ttl('CNAME') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_target_name('CNAME') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_comment('CNAME') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_views('CNAME') }}</td>
                <td></td>
            </tr>
            </table>
        </div>

        <div class="rec_final" id="CNAME_final">
            {{ display_rec_name('CNAME') }}
            {{ display_rec_type('CNAME') }}
            {{ display_rec_ttl('CNAME') }}
            {{ display_target_name('CNAME') }}
            {{ display_rec_comment('CNAME') }}
        </div>
    </div>

    <div id="SRV_display">
        <div class="rec_build" id="SRV_build">
            <table>
            <tr>
                <td>{{ draw_build_label('SRV') }}</td>
                <td>{{ draw_build_domain('SRV', domains) }}</td>
            </tr>
            <tr>
                <td>{{ draw_build_ttl('SRV') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_number('SRV', 'Port') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_number('SRV', 'Weight') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_prio('SRV') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_target_name('SRV') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_comment('SRV') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_views('SRV') }}</td>
                <td></td>
            </tr>
            </table>
        </div>

        <div class="rec_final" id="SRV_final">
            {{ display_rec_name('SRV') }}
            {{ display_rec_type('SRV') }}
            {{ display_rec_ttl('SRV') }}
            {{ display_rec_attr('SRV', 'Port', 'Port', reset='false') }}
            {{ display_rec_attr('SRV', 'Weight', 'Weight', reset='false') }}
            {{ display_rec_attr('SRV', 'Priority', 'Priority', reset='false') }}
            {{ display_target_name('SRV') }}
            {{ display_rec_comment('SRV') }}
        </div>
    </div>

    <div id="TXT_display">
        <div class="rec_build" id="TXT_build">
            <table>
            <tr>
                <td>{{ draw_build_label('TXT') }}</td>
                <td>{{ draw_build_domain('TXT', domains) }}</td>
            </tr>
            <tr>
                <td>{{ draw_build_ttl('TXT') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_text('TXT') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_comment('TXT') }}</td>
                <td></td>
            </tr>
            <tr>
                <td>{{ draw_build_views('TXT') }}</td>
                <td></td>
            </tr>
            </table>
        </div>

        <div class="rec_final" id="TXT_final">
            {{ display_rec_name('TXT') }}
            {{ display_rec_type('TXT') }}
            {{ display_rec_ttl('TXT') }}
            {{ display_rec_text('TXT') }}
            {{ display_rec_comment('TXT') }}
        </div>
    </div>
    <br>
    <div id="dns_return">
        <div id="dns_form_errors">
            <ul id="error_list">
            </ul>
        </div>
        <div id="dns_success">
            <ul id="success_list">
            </ul>
        </div>
    </div>

    </form>
{% endblock %}
